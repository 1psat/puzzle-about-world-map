<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Игра-пазл</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Игра-пазл</h1>
    <div id="buttons">
        <button onclick="loadPuzzle('world')">Физическая карта мира</button>
        <button onclick="loadPuzzle('kazakhstan')">Физическая Карта Казахстана</button>
    </div>
    <div id="puzzle-container"></div>
    <div id="puzzle-pieces"></div>
    <script src="script.js"></script>
</body>
</html>
body {
    font-family: 'Arial', sans-serif;
    text-align: center;
    background-color: #f0f0f0;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
}

h1 {
    color: #333;
    margin: 20px 0;
}

#buttons {
    margin: 20px;
}

#puzzle-container {
    display: grid;
    gap: 2px;
    justify-content: center;
    margin: 20px auto;
    background-color: #fff;
    padding: 10px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

#puzzle-pieces {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    justify-content: center;
}

.puzzle-piece {
    background-color: #ccc;
    border: 1px solid #000;
    cursor: pointer;
    user-select: none;
    transition: transform 0.2s;
    background-repeat: no-repeat;
}

.puzzle-piece:hover {
    transform: scale(1.1);
}

button {
    padding: 10px 20px;
    font-size: 16px;
    margin: 10px;
    cursor: pointer;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    transition: background-color 0.3s;
}

button:hover {
    background-color: #0056b3;
}
const puzzles = {
    world: {
        bw: 'world_bw.jpg',  // Черно-белая карта мира
        levels: [3, 4, 6]
    },
    kazakhstan: {
        bw: 'kazakhstan_bw.jpg',  // Черно-белая карта Казахстана
        levels: [3, 4, 6]
    }
};

function loadPuzzle(type) {
    const puzzleContainer = document.getElementById('puzzle-container');
    const puzzlePiecesContainer = document.getElementById('puzzle-pieces');
    puzzleContainer.innerHTML = '';
    puzzlePiecesContainer.innerHTML = '';

    const puzzle = puzzles[type];
    const level = parseInt(prompt('Выберите уровень (3x3, 4x4, 6x6):'));

    if (!puzzle.levels.includes(level)) {
        alert('Неверный уровень!');
        return;
    }

    const numPieces = level * level;
    const puzzleSize = 300; // Размер одной стороны пазла в пикселях для отображения
    puzzleContainer.style.gridTemplateColumns = repeat(${level}, ${puzzleSize / level}px);
    puzzleContainer.style.gridTemplateRows = repeat(${level}, ${puzzleSize / level}px);

    const pieceSize = 1800 / level; // Размер одной стороны оригинального изображения в пикселях
    const pieces = [];
    for (let i = 0; i < numPieces; i++) {
        const piece = document.createElement('div');
        piece.className = 'puzzle-piece';
        piece.style.width = ${puzzleSize / level}px;
        piece.style.height = ${puzzleSize / level}px;
        piece.style.backgroundImage = url(${puzzle.bw});
        piece.style.backgroundSize = ${puzzleSize}px ${puzzleSize}px;
        piece.style.backgroundPosition = ${-((i % level) * (puzzleSize / level))}px ${-Math.floor(i / level) * (puzzleSize / level)}px;
        piece.draggable = true;
        piece.dataset.index = i;
        pieces.push(piece);
    }

    pieces.sort(() => Math.random() - 0.5); // Перемешиваем кусочки
    pieces.forEach(piece => puzzlePiecesContainer.appendChild(piece));

    let draggedElement = null;

    puzzlePiecesContainer.addEventListener('dragstart', (event) => {
        draggedElement = event.target;
    });

    puzzleContainer.addEventListener('dragover', (event) => {
        event.preventDefault();
    });

    puzzleContainer.addEventListener('drop', (event) => {
        if (event.target.className === 'puzzle-piece' || event.target.id === 'puzzle-container') {
            const target = event.target.className === 'puzzle-piece' ? event.target : event.target.parentNode;
            const targetIndex = target.dataset.index;
            const draggedIndex = draggedElement.dataset.index;

            // Меняем местами позиции только при перетаскивании в сетку контейнера пазлов
            if (targetIndex === undefined) {
                puzzleContainer.appendChild(draggedElement);
            } else {
                [target.style.backgroundPosition, draggedElement.style.backgroundPosition] = [draggedElement.style.backgroundPosition, target.style.backgroundPosition];
                [target.dataset.index, draggedElement.dataset.index] = [draggedIndex, targetIndex];
            }

            checkPuzzleCompletion(puzzle, level);
        }
    });
}

function checkPuzzleCompletion(puzzle, level) {
    const pieces = document.querySelectorAll('#puzzle-container .puzzle-piece');
    for (let i = 0; i < pieces.length; i++) {
        if (pieces[i].dataset.index != i) return;
    }
    alert('Вы собрали пазл!');
    clearPuzzle();
}

function clearPuzzle() {
    const puzzleContainer = document.getElementById('puzzle-container');
    puzzleContainer.innerHTML = '';
    const message = document.createElement('div');
    message.textContent = 'Вы собрали пазл!';
    message.style.fontSize = '24px';
    message.style.color = '#333';
    puzzleContainer.appendChild(message);
}
